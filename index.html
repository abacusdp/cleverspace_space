<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<title>SPACE</title>
<link rel="stylesheet" href="index.css">
<script type="text/javascript" src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script type="text/javascript">
 
</script>
</head>
<body>
	<div>
	<div id="checkboxwrapper">
	<div id="checkbox">
		<h2>LOCATION</h2><br>
	<label> <input name="selector[]" id="checkAll" class="ads_Checkbox" type="checkbox"/>Select All</label><br>
	<label><input name="selector[]" id="ad_Checkbox1" class="ads_Checkbox" type="checkbox" value="MUMBAI" />Mumbai</label><br>
	 <label><input name="selector[]" id="ad_Checkbox2" class="ads_Checkbox" type="checkbox" value="HEAD OFFICE" />Head Office</label><br>
	   <label><input name="selector[]" id="ad_Checkbox3" class="ads_Checkbox" type="checkbox" value="DELHI" />Delhi</label><br>
		 <label><input name="selector[]" id="ad_Checkbox4" class="ads_Checkbox" type="checkbox" value="BANGALORE" />Bangalore</label>
		 </div><br>
		 <div id="checkbox1">
			<h2>ZONE</h2><br>
		 <label> <input name="selector[]" id="checkAllZone" class="ads_Checkbox1" type="checkbox"/>Select All</label><br>
	<label><input name="selector[]" id="ad_Checkbox10" class="ads_Checkbox1" type="checkbox" value="1" />1</label><br>
	 <label><input name="selector[]" id="ad_Checkbox20" class="ads_Checkbox1" type="checkbox" value="2" />2</label>
	
	</div><br>
	<div id="filter">
		 <label><input type="button" id="save_value" name="save_value" value="Add Filter"/></div>
		 </div><br><br>
			
     	<div id="wrapper">
			 <div id="chartContainer" ></div><br>
			 <div id="chartContainer1"></div><br>
			 <div id="chartContainer2"></div><br>
			 <div id="chartContainer3"></div>
		</div>
	</div>
  <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
  <script>
	var qwerty = [
    {
      "c": "MUMBAI",
      "ZONE": 1,
      "OCCUPANCY": 23,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 32,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 1,
      "OCCUPANCY": 24,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 1,
      "OCCUPANCY": 21,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 1,
      "OCCUPANCY": 34,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 1,
      "OCCUPANCY": 43,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 1,
      "OCCUPANCY": 42,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 28,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 1,
      "OCCUPANCY": 31,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 1,
      "OCCUPANCY": 23,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 30,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 1,
      "OCCUPANCY": 46,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 1,
      "OCCUPANCY": 43,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 1,
      "OCCUPANCY": 23,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 28,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 1,
      "OCCUPANCY": 43,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 1,
      "OCCUPANCY": 36,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 1,
      "OCCUPANCY": 37,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 1,
      "OCCUPANCY": 32,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 1,
      "OCCUPANCY": 31,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 2,
      "OCCUPANCY": 26,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 2,
      "OCCUPANCY": 24,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 2,
      "OCCUPANCY": 41,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 2,
      "OCCUPANCY": 26,
      "DATE": "3/1/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 2,
      "OCCUPANCY": 23,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 2,
      "OCCUPANCY": 28,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 2,
      "OCCUPANCY": 21,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 2,
      "OCCUPANCY": 32,
      "DATE": "3/2/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 2,
      "OCCUPANCY": 36,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 2,
      "OCCUPANCY": 35,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 2,
      "OCCUPANCY": 26,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 2,
      "OCCUPANCY": 28,
      "DATE": "3/3/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    },
    {
      "c": "MUMBAI",
      "ZONE": 2,
      "OCCUPANCY": 23,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 125,
      "TEMP": 23,
      "HUMIDITY": 78,
      "CAPACITY": 30
    },
    {
      "c": "HEAD OFFICE",
      "ZONE": 2,
      "OCCUPANCY": 24,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 130,
      "TEMP": 24,
      "HUMIDITY": 85,
      "CAPACITY": 30
    },
    {
      "c": "DELHI",
      "ZONE": 2,
      "OCCUPANCY": 21,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 140,
      "TEMP": 25,
      "HUMIDITY": 87,
      "CAPACITY": 30
    },
    {
      "c": "BANGALORE",
      "ZONE": 2,
      "OCCUPANCY": 32,
      "DATE": "3/4/2019 12:00:00 AM",
      "LIGHT": 70,
      "TEMP": 35,
      "HUMIDITY": 98,
      "CAPACITY": 30
    }
  ]
  	var occDataPointsOVC=[]
  	var capDataPointsOVC=[]
  	OccupancyCapacity(["MUMBAI","HEAD OFFICE","DELHI","BANGALORE"],[1,2])
  	function OccupancyCapacity(locNames,zoneNames){

		
	occDataPointsOVC=[]
	capDataPointsOVC=[]
	humDataPointsHVO=[]
	illDataPointsIVO=[]
	tempDataPointsTVO=[]
  
	let xOccupancy={}
	let yCapacity={}
let xHumidity={}
let xIlluminance={}
let xTemp={}

let humidityCount={}
let illCount={}
let tempCount={}

	qwerty.forEach(function(obj,index){
	  if(locNames.includes(obj.c) &&  zoneNames.includes(obj.ZONE)){
		  console.log(obj);
		  if(obj.DATE in xOccupancy ){
			xOccupancy[obj.DATE]+=obj.OCCUPANCY
		  }
		  else{
			xOccupancy[obj.DATE]=0
		  }

		  if(obj.DATE in yCapacity ){
			yCapacity[obj.DATE]+=obj.CAPACITY
		  }
		  else{
			yCapacity[obj.DATE]=0
		  }
		  if(obj.DATE in xHumidity ){
			humidityCount[obj.DATE]+=1;
			xHumidity[obj.DATE]+=obj.HUMIDITY
		  }
		  else{
			humidityCount[obj.DATE]=1;
			xHumidity[obj.DATE]=0
		  }

		  if(obj.DATE in xIlluminance ){
			illCount[obj.DATE]+=1;
			xIlluminance[obj.DATE]+=obj.LIGHT
		  }
		  else{
			illCount[obj.DATE]=1;
			xIlluminance[obj.DATE]=0
		  }
		  
		  if(obj.DATE in xTemp ){
			tempCount[obj.DATE]+=1;
			xTemp[obj.DATE]+=obj.TEMP
		  }
		  else{
			tempCount[obj.DATE]=1;
			xTemp[obj.DATE]=0
		  }
	  }  
	})
 	let indexOccupancy=0,indexCapacity=0,indexHumidity=0,indexIll=0,indexTemp
	for(let[key,value] of Object.entries(xOccupancy)){
	  indexOccupancy++
	  occDataPointsOVC.push({x:new Date(key),y:value})
	}
	for(let[key,value] of Object.entries(yCapacity)){
	  indexCapacity++
	  capDataPointsOVC.push({x:new Date(key),y:value})

	}
	for(let[key,value] of Object.entries(xHumidity)){
		indexHumidity++
		humDataPointsHVO.push({x:new Date(key),y:value/humidityCount[key]})
	  }
	  for(let[key,value] of Object.entries(xIlluminance)){
		indexIll++
		illDataPointsIVO.push({x:new Date(key),y:value/illCount[key]})
	  }
	  

	  for(let[key,value] of Object.entries(xTemp)){
		indexTemp++
		tempDataPointsTVO.push({x:new Date(key),y:value/tempCount[key]})
	  }
	  console.log(tempCount)
	//chart.data[0].dataPoints[0] = occDataPointsOVC;
	//chart.data[1].dataPoints[0] = capDataPointsOVC;
	//chart.render();

	}

// Checked all zone and loc
$('.ads_Checkbox').prop('checked', 'checked');
$('.ads_Checkbox1').prop('checked', 'checked');


$('#checkAll').click(function () {    
	$('.ads_Checkbox').prop('checked', this.checked);    
});

$('#checkAllZone').click(function () {    
	$('.ads_Checkbox1').prop('checked', this.checked);    
});

    var chart = new CanvasJS.Chart("chartContainer", {
      zoomEnabled: true,
      title:{
		text: "Occupancy v/s Capacity",
		fontFamily: "Arial, Helvetica, sans-serif",
		fontStyle: "Bold"
	  },  
	  axisX:{      
		valueFormatString: "DD MMM,YY" ,
		labelAngle: -50
	},
      axisY: {
		  color:"rgba(84,161,183,1)",
        columnColor: "rgba(84,161,183,1)",
        lineColor: "rgba(84,161,183,1)",
        xFontColor: "rgba(84,161,183,1)",
        tickColor: "rgba(84,161,183,1)"
      },
      axisY2: {
		  color:"rgba(100,183,154,1)",
        columnColor: "rgba(100,183,154,1)",
        lineColor: "rgba(100,183,154,1)",
        xFontColor: "rgba(100,183,154,1)",
        tickColor: "rgba(100,183,154,1)"
      },  
      toolTip: {
        shared: true
      },
      legend: {
		cursor:"pointer",
		itemclick: toggleDataSeries},
      data: [{
		type: "column",
		color:"rgba(100,183,154,1)",
        name: "Occupancy",
        legendText: "Occupancy",
        showInLegend: true, 
        dataPoints:occDataPointsOVC
      },
      {
		type: "column", 
		color:"rgba(84,161,183,1)",
        name: "Capacity",
        legendText: "Capacity",
        axisYType: "secondary",
        showInLegend: true,
        dataPoints:capDataPointsOVC
      }]
    });
	chart.render();
	var chart1 = new CanvasJS.Chart("chartContainer1", {
		zoomEnabled: true,
		title:{
		  text: "Humidity to Occupancy",
		  fontFamily: "Arial, Helvetica, sans-serif",
		  fontStyle: "Bold"
		},  
		axisX:{      
		  valueFormatString: "DD MMM,YY" ,
		  labelAngle: -50
	  },
		axisY: {
			color:"rgba(84,161,183,1)",
		  columnColor: "rgba(84,161,183,1)",
		  lineColor: "rgba(84,161,183,1)",
		  xFontColor: "rgba(84,161,183,1)",
		  tickColor: "rgba(84,161,183,1)"
		},
		axisY2: {
			color:"rgba(100,183,154,1)",
		  columnColor: "rgba(100,183,154,1)",
		  lineColor: "rgba(100,183,154,1)",
		  xFontColor: "rgba(100,183,154,1)",
		  tickColor: "rgba(100,183,154,1)"
		},  
		toolTip: {
		  shared: true
		},
		legend: {
		  cursor:"pointer",
		  itemclick: toggleDataSeries
		},
		data: [{
		  type: "column",
		  color:"rgba(100,183,154,1)",
		  name: "Occupancy",
		  legendText: "Occupancy",
		  showInLegend: true, 
		  dataPoints:occDataPointsOVC
		},
		{
		  type: "column", 
		  color:"rgba(84,161,183,1)",
		  name: "Humidity",
		  legendText: "Humidity",
		  axisYType: "secondary",
		  showInLegend: true,
		  dataPoints:humDataPointsHVO
		}]
	  });
	  chart1.render();	
	var chart2 = new CanvasJS.Chart("chartContainer2", {
		zoomEnabled: true,
		title:{
		  text: "Avg. Illuminance to Occupancy",
		  fontFamily: "Arial, Helvetica, sans-serif",
		  fontStyle: "Bold"
		},  
		axisX:{      
		  valueFormatString: "DD MMM,YY" ,
		  labelAngle: -50
	  },
		axisY: {
			color:"rgba(84,161,183,1)",
		  columnColor: "rgba(84,161,183,1)",
		  lineColor: "rgba(84,161,183,1)",
		  xFontColor: "rgba(84,161,183,1)",
		  tickColor: "rgba(84,161,183,1)"
		},
		axisY2: {
			color:"rgba(100,183,154,1)",
		  columnColor: "rgba(100,183,154,1)",
		  lineColor: "rgba(100,183,154,1)",
		  xFontColor: "rgba(100,183,154,1)",
		  tickColor: "rgba(100,183,154,1)"
		},  
		toolTip: {
		  shared: true
		},
		legend: {
		  cursor:"pointer",
		  itemclick: toggleDataSeries
		},
		data: [{
		  type: "column",
		  color:"rgba(100,183,154,1)",
		  name: "Occupancy",
		  legendText: "Occupancy",
		  showInLegend: true, 
		  dataPoints:occDataPointsOVC
		},
		{
		  type: "column", 
		  color:"rgba(84,161,183,1)",
		  name: "Illuminance",
		  legendText: "Illuminance",
		  axisYType: "secondary",
		  showInLegend: true,
		  dataPoints:illDataPointsIVO
		}]
	  });
	  chart2.render();  
//======================================================
var chart3 = new CanvasJS.Chart("chartContainer3", {
	zoomEnabled: true,
	title:{
	  text: "Ambient Temperature to Occupancy",
	  fontFamily: "Arial, Helvetica, sans-serif",
	  fontStyle: "Bold"
	},  
	axisX:{      
	  valueFormatString: "DD MMM,YY" ,
	  labelAngle: -50
  },
	axisY: {
		color:"rgba(84,161,183,1)",
	  columnColor: "rgba(84,161,183,1)",
	  lineColor: "rgba(84,161,183,1)",
	  xFontColor: "rgba(84,161,183,1)",
	  tickColor: "rgba(84,161,183,1)"
	},
	axisY2: {
		color:"rgba(100,183,154,1)",
	  columnColor: "rgba(100,183,154,1)",
	  lineColor: "rgba(100,183,154,1)",
	  xFontColor: "rgba(100,183,154,1)",
	  tickColor: "rgba(100,183,154,1)"
	},  
	toolTip: {
	  shared: true
	},
	legend: {
	  cursor:"pointer",
	  itemclick: toggleDataSeries
	},
	data: [{
	  type: "column",
	  color:"rgba(100,183,154,1)",
	  name: "Occupancy",
	  legendText: "Occupancy",
	  showInLegend: true, 
	  dataPoints:occDataPointsOVC
	},
	{
	  type: "column", 
	  color:"rgba(84,161,183,1)",
	  name: "Temperature",
	  legendText: "Temperature",
	  axisYType: "secondary",
	  showInLegend: true,
	  dataPoints:tempDataPointsTVO
	}]
  });
  chart3.render(); 
    
    function toggleDataSeries(e) {
      if (typeof(e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
        e.dataSeries.visible = false;
      }
      else {
        e.dataSeries.visible = true;
      }
	  chart.render();
	  chart1.render();
	  chart2.render();
	  chart3.render();
    }
    var limit = 1000;    //increase number of dataPoints by increasing this
        
     

	document.getElementById("save_value").addEventListener("click", function(e) {
		  var loc = [];var zone=[];
		  $('.ads_Checkbox:checked').each(function(i){
			loc[i] = $(this).val();
		  });
		  $('.ads_Checkbox1:checked').each(function(i){
			zone[i] =parseInt( $(this).val());
		  });

		  let indexVal=loc.indexOf("on")
		  let indexZone=zone.indexOf("on")
	
		  if(indexVal>-1){
			  
			loc.splice(indexVal,1)
		  }

		  if(indexZone>-1){
			  
			zone.splice(indexZone,1)
		  }

		  OccupancyCapacity(loc,zone)
		  chart.options.data[0].dataPoints = occDataPointsOVC;
		  chart.options.data[1].dataPoints = capDataPointsOVC;
		  chart.render();
		  // For chart 2
		  chart1.options.data[0].dataPoints = occDataPointsOVC;
		  chart1.options.data[1].dataPoints = humDataPointsHVO;
		  chart1.render();
		  chart2.options.data[0].dataPoints = occDataPointsOVC;
		  chart2.options.data[1].dataPoints = illDataPointsIVO;
		  chart2.render();
		  chart3.options.data[0].dataPoints = occDataPointsOVC;
		  chart3.options.data[1].dataPoints = tempDataPointsTVO;
	      chart3.render();
		});
		
		
		
    </script>
</body>
</html>
